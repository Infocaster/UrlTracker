using System.Web.Http;
using Umbraco.Core.Composing;

namespace UrlTracker.Resources.Website.Composing
{
    public class NewtonsoftVulnerabilityComposer
        : ComponentComposer<NewtonsoftVulnerabilityComponent>
    { }

    public class NewtonsoftVulnerabilityComponent : IComponent
    {
        public void Initialize()
        {
            //Mitigation for https://github.com/JamesNK/Newtonsoft.Json/pull/2462
            //Snyk: https://security.snyk.io/vuln/SNYK-DOTNET-NEWTONSOFTJSON-2774678
            //Mitre: https://cwe.mitre.org/data/definitions/755.html
            GlobalConfiguration.Configuration.Formatters.JsonFormatter.SerializerSettings.MaxDepth = 128;
        }

        public void Terminate()
        { }
    }
}